---
slug: golang-slice-common-mistakes-and-pitfalls
title: "Golangä¸­çš„ Slice å¸¸è§é”™è¯¯å’Œé™·é˜±è§£æ"
description: "æ¢ç´¢åœ¨ä½¿ç”¨ Golang ç¼–ç¨‹è¯­è¨€ä¸­çš„ slice æ—¶å¸¸è§çš„é”™è¯¯å’Œé™·é˜±ï¼Œæ·±å…¥è§£æè¿™äº›é—®é¢˜çš„æ ¹æºå¹¶æä¾›æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆä¸å®è·µå»ºè®®ï¼Œå¸®åŠ©å¼€å‘è€…é¿å…å¸¸è§é™·é˜±ï¼Œæé«˜ä»£ç è´¨é‡å’Œæ•ˆç‡ã€‚"
authors: [wifecooky]
tags: [Golang, Slice]
keywords: [Golang, Slice, å¸¸è§é”™è¯¯]
image: golang-slice.webp
---

## 1. Slice æ˜¯ä»€ä¹ˆï¼Ÿ

Slice æ˜¯ Go è¯­è¨€ä¸­çš„ä¸€ç§ç±»ä¼¼æ•°ç»„çš„æ•°æ®ç»“æ„ï¼Œæ˜¯å¯¹æ•°ç»„çš„ä¸€ä¸ªå°è£…ã€‚

å’Œæ•°ç»„ç›¸æ¯”ï¼Œslice çš„é•¿åº¦æ˜¯å¯ä»¥åŠ¨æ€å˜åŒ–çš„ï¼Œå¯ä»¥é€šè¿‡å†…ç½®å‡½æ•° `append` æ¥åŠ¨æ€å¢åŠ åˆ‡ç‰‡çš„é•¿åº¦ã€‚

![img](golang-slice.webp)

## 2. Slice çš„æ³¨æ„äº‹é¡¹å’Œå¸¸è§é”™è¯¯ä»¥åŠé™·é˜±

### 2.1. æœªåˆå§‹åŒ–çš„åˆ‡ç‰‡

æœªåˆå§‹åŒ–çš„åˆ‡ç‰‡æ˜¯ nilï¼Œå¯¹å…¶è¿›è¡Œæ“ä½œä¼šå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯ã€‚

```go
package main

import "fmt"

func main() {
    var fruits []string
    // fruits[0] = "ğŸ" // è¿™ä¼šå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯ï¼španic: runtime error: index out of range [0] with length 0

    // æ­£ç¡®åšæ³•1ï¼šåˆå§‹åŒ–åˆ‡ç‰‡
    fruits := make([]string, 1)
    fruits[0] = "ğŸ"

    // æ­£ç¡®åšæ³•2ï¼šä½¿ç”¨å­—é¢é‡åˆå§‹åŒ–åˆ‡ç‰‡
    fruits := []string{"ğŸ"}

    // æ­£ç¡®åšæ³•3ï¼šä½¿ç”¨ append å‡½æ•°åˆå§‹åŒ–åˆ‡ç‰‡ã€‚ï¼ˆå¦‚æœä¸æ˜¯ç‰¹åˆ«æ³¨é‡æ€§èƒ½ï¼Œè¿™ç§æ–¹å¼æ˜¯æœ€ç®€å•çš„ã€‚ï¼‰
    fruits = append(fruits, "ğŸ")
}
```

### 2.2. ä½¿ç”¨ `append` å‡½æ•°æ—¶ï¼Œæ³¨æ„é‡æ–°èµ‹å€¼

`append` å‡½æ•°ä¼šåœ¨å®¹é‡ä¸è¶³æ—¶é‡æ–°åˆ†é…ä¸€ä¸ªæ›´å¤§çš„åº•å±‚æ•°ç»„ï¼Œå¹¶å°†åŸæ¥çš„æ•°æ®å¤åˆ¶åˆ°æ–°çš„æ•°ç»„ä¸­ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„åˆ‡ç‰‡ï¼Œ

æ‰€ä»¥æ³¨æ„åœ¨ä½¿ç”¨ `append` å‡½æ•°æ—¶ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨åŸæ¥çš„åˆ‡ç‰‡å˜é‡ï¼Œå°±éœ€è¦é‡æ–°èµ‹å€¼ã€‚

```go
    fruits := []string{"ğŸ"}
    fruits = append(fruits, "ğŸŒ")
```

### 2.3. åˆ‡ç‰‡ä½œä¸ºå‡½æ•°å‚æ•°æ—¶çš„å¼•ç”¨é—®é¢˜

åˆ‡ç‰‡æ˜¯å¼•ç”¨ç±»å‹ï¼Œæ‰€ä»¥åœ¨å‡½æ•°å‚æ•°ä¸­ä¼ é€’åˆ‡ç‰‡æ—¶ï¼Œå®é™…ä¸Šæ˜¯ä¼ é€’äº†åˆ‡ç‰‡çš„å¼•ç”¨ã€‚

```go
func modifyFruits(fruits []string) {
    fruits[0] = "ğŸŒ"
}

func main() {
    fruits := []string{"ğŸ", "ğŸŒ"}
    fmt.Println("Before modification:", fruits) // è¾“å‡º: Before modification: [ğŸ ğŸŒ]

    modifyFruits(fruits)
    fmt.Println("After modification:", fruits) // è¾“å‡º: After modification: [ğŸŒ ğŸŒ]
}
```

### 2.4. åˆ‡ç‰‡çš„æˆªå–

åˆ‡ç‰‡çš„æˆªå–æ“ä½œæ˜¯å·¦é—­å³å¼€çš„ï¼Œå³ `a[1:3]` è¡¨ç¤ºä»ä¸‹æ ‡ 1 å¼€å§‹åˆ°ä¸‹æ ‡ 3 ç»“æŸï¼Œä½†ä¸åŒ…æ‹¬ä¸‹æ ‡ 3ã€‚

```go
    fruits := []string{"ğŸ", "ğŸŒ", "ğŸ‡", "ğŸ‰"}
    fmt.Println(fruits[1:3]) // è¾“å‡º: [ğŸŒ ğŸ‡]
```

### 2.5. åˆ‡ç‰‡çš„é•¿åº¦å’Œå®¹é‡æ··æ·†

åˆ‡ç‰‡çš„é•¿åº¦æ˜¯æŒ‡åˆ‡ç‰‡ä¸­å…ƒç´ çš„ä¸ªæ•°ï¼Œå®¹é‡æ˜¯æŒ‡åˆ‡ç‰‡åº•å±‚æ•°ç»„çš„é•¿åº¦ã€‚

```go
    fruits := make([]string, 2, 5)
    fmt.Println("Length:", len(fruits), "Capacity:", cap(fruits)) // è¾“å‡º: Length: 2 Capacity: 5

    // fruits[3] = "ğŸ‡" // è¿™ä¼šå¯¼è‡´è¿è¡Œæ—¶é”™è¯¯ï¼španic: runtime error: index out of range [3] with length 2

    // æ­£ç¡®åšæ³•ï¼šä½¿ç”¨ append æ¥æ·»åŠ å…ƒç´ 
    fruits = append(fruits, "ğŸ‡")
```

### 2.6. åˆ‡ç‰‡çš„å¤åˆ¶

åˆ‡ç‰‡çš„å¤åˆ¶æ˜¯æµ…æ‹·è´ï¼Œå³å¤åˆ¶çš„æ˜¯åˆ‡ç‰‡çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯åˆ‡ç‰‡çš„åº•å±‚æ•°ç»„ã€‚

è¿™ä¸ªå’Œå‡½æ•°å‚æ•°ä¼ é€’çš„å¼•ç”¨æ˜¯ç±»ä¼¼çš„ã€‚

```go
    fruits := []string{"ğŸ", "ğŸŒ"}
    fruitsCopy := fruits
    fruitsCopy[0] = "ğŸŒ"
    fmt.Println("Original slice:", fruits) // è¾“å‡º: Original slice: [ğŸŒ ğŸŒ]
```
